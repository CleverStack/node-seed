(function(e){"use strict";if(!e.ng){e.ng={}}e.ngGrid={};e.ngGrid.i18n={};var t=angular.module("ngGrid.services",[]);var n=angular.module("ngGrid.directives",[]);var r=angular.module("ngGrid.filters",[]);var i=6;var s=4;var o="asc";var u="desc";var a="_ng_selected_";var f="_ng_field_";var l="_ng_depth_";var c="_ng_hidden_";var h="_ng_column_";var p=/CUSTOM_FILTERS/g;var d=/COL_FIELD/g;var v=/DISPLAY_CELL_TEMPLATE/g;var m=/EDITABLE_CELL_TEMPLATE/g;var g=/<.+>/;ng.moveSelectionHandler=function(e,t,n,r){if(e.selectionService.selectedItems===undefined){return true}var s=n.which||n.keyCode,o,u=false,a=false,f=e.selectionService.lastClickedRow.rowIndex;if(e.col){o=e.col.index}if(s!=37&&s!=38&&s!=39&&s!=40&&s!=9&&s!=13){return true}if(e.enableCellSelection){if(s==9){n.preventDefault()}var l=e.showSelectionCheckbox?e.col.index==1:e.col.index==0;var c=e.$index==1||e.$index==0;var h=e.$index==e.renderedColumns.length-1||e.$index==e.renderedColumns.length-2;var p=e.col.index==e.columns.length-1;if(s==37||s==9&&n.shiftKey){if(c){if(l&&s==9&&n.shiftKey){r.$viewport.scrollLeft(r.$canvas.width());o=e.columns.length-1;a=true}else{r.$viewport.scrollLeft(r.$viewport.scrollLeft()-e.col.width)}}if(!l){o-=1}}else if(s==39||s==9&&!n.shiftKey){if(h){if(p&&s==9&&!n.shiftKey){r.$viewport.scrollLeft(0);o=e.showSelectionCheckbox?1:0;u=true}else{r.$viewport.scrollLeft(r.$viewport.scrollLeft()+e.col.width)}}if(!p){o+=1}}}var d;if(e.configGroups.length>0){d=r.rowFactory.parsedData.filter(function(e){return!e.isAggRow})}else{d=r.filteredRows}var v=0;if(f!=0&&(s==38||s==13&&n.shiftKey||s==9&&n.shiftKey&&a)){v=-1}else if(f!=d.length-1&&(s==40||s==13&&!n.shiftKey||s==9&&u)){v=1}if(v){var m=d[f+v];if(m.beforeSelectionChange(m,n)){m.continueSelection(n);e.$emit("ngGridEventDigestGridParent");if(e.selectionService.lastClickedRow.renderedRowIndex>=e.renderedRows.length-i-2){r.$viewport.scrollTop(r.$viewport.scrollTop()+e.rowHeight)}else if(e.selectionService.lastClickedRow.renderedRowIndex<=i+2){r.$viewport.scrollTop(r.$viewport.scrollTop()-e.rowHeight)}}}if(e.enableCellSelection){setTimeout(function(){e.domAccessProvider.focusCellElement(e,e.renderedColumns.indexOf(e.columns[o]))},3)}return false};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=this.length>>>0;var n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n);if(n<0){n+=t}for(;n<t;n++){if(n in this&&this[n]===e){return n}}return-1}}if(!Array.prototype.filter){Array.prototype.filter=function(e){"use strict";var t=Object(this);var n=t.length>>>0;if(typeof e!=="function"){throw new TypeError}var r=[];var i=arguments[1];for(var s=0;s<n;s++){if(s in t){var o=t[s];if(e.call(i,o,s,t)){r.push(o)}}}return r}}ng.utils={visualLength:function(e){var t=document.getElementById("testDataLength");if(!t){t=document.createElement("SPAN");t.id="testDataLength";t.style.visibility="hidden";document.body.appendChild(t)}$(t).css("font",$(e).css("font"));t.innerHTML=$(e).text();return t.offsetWidth},forIn:function(e,t){for(var n in e){if(e.hasOwnProperty(n)){t(e[n],n)}}},evalProperty:function(e,t){var n=t.split("."),r=0;var i=e[n[r]],s=n.length;r++;while(i&&r<s){i=i[n[r]];r++}return i},endsWith:function(e,t){if(!e||!t||typeof e!="string"){return false}return e.indexOf(t,e.length-t.length)!==-1},isNullOrUndefined:function(e){if(e===undefined||e===null){return true}return false},getElementsByClassName:function(e){var t=[];var n=new RegExp("\\b"+e+"\\b");var r=document.getElementsByTagName("*");for(var i=0;i<r.length;i++){var s=r[i].className;if(n.test(s)){t.push(r[i])}}return t},newId:function(){var e=(new Date).getTime();return function(){return e+=1}}(),seti18n:function(t,n){var r=e.ngGrid.i18n[n];for(var i in r){t.i18n[i]=r[i]}},ieVersion:function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");while(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0]);return e>4?e:undefined}()};$.extend(ng.utils,{isIe6:function(){return ng.utils.ieVersion===6}(),isIe7:function(){return ng.utils.ieVersion===7}(),isIe:function(){return ng.utils.ieVersion!==undefined}()});r.filter("ngColumns",function(){return function(e){return e.filter(function(e){return!e.isAggCol})}});r.filter("checkmark",function(){return function(e){return e?"✔":"✘"}});t.factory("SortService",["$parse",function(e){var t={};t.colSortFnCache={};t.guessSortFn=function(e){var n=typeof e;switch(n){case"number":return t.sortNumber;case"boolean":return t.sortBool;case"string":return e.match(/^-?[£$¤]?[\d,.]+%?$/)?t.sortNumberStr:t.sortAlpha;default:if(Object.prototype.toString.call(e)==="[object Date]"){return t.sortDate}else{return t.basicSort}}};t.basicSort=function(e,t){if(e==t){return 0}if(e<t){return-1}return 1};t.sortNumber=function(e,t){return e-t};t.sortNumberStr=function(e,t){var n,r,i=false,s=false;n=parseFloat(e.replace(/[^0-9.-]/g,""));if(isNaN(n)){i=true}r=parseFloat(t.replace(/[^0-9.-]/g,""));if(isNaN(r)){s=true}if(i&&s){return 0}if(i){return 1}if(s){return-1}return n-r};t.sortAlpha=function(e,t){var n=e.toLowerCase(),r=t.toLowerCase();return n==r?0:n<r?-1:1};t.sortDate=function(e,t){var n=e.getTime(),r=t.getTime();return n==r?0:n<r?-1:1};t.sortBool=function(e,t){if(e&&t){return 0}if(!e&&!t){return 0}else{return e?1:-1}};t.sortData=function(n,r){if(!r||!n){return}var i=n.fields.length,s=n.fields,u,a,f=r.slice(0);r.sort(function(r,l){var c=0,h=0,p;while(c==0&&h<i){u=n.columns[h];a=n.directions[h],p=t.getSortFn(u,f);var d=e(s[h])(r);var v=e(s[h])(l);if(!d&&d!=0||!v&&v!=0){if(!v&&!d){c=0}else if(!d){c=1}else if(!v){c=-1}}else{c=p(d,v)}h++}if(a===o){return c}else{return 0-c}})};t.Sort=function(e,n){if(t.isSorting){return}t.isSorting=true;t.sortData(e,n);t.isSorting=false};t.getSortFn=function(n,r){var i=undefined,s;if(t.colSortFnCache[n.field]){i=t.colSortFnCache[n.field]}else if(n.sortingAlgorithm!=undefined){i=n.sortingAlgorithm;t.colSortFnCache[n.field]=n.sortingAlgorithm}else{s=r[0];if(!s){return i}i=t.guessSortFn(e(n.field)(s));if(i){t.colSortFnCache[n.field]=i}else{i=t.sortAlpha}}return i};return t}]);t.factory("DomUtilityService",function(){var e={};var t={};var n=function(){var t=$("<div></div>");t.appendTo("body");t.height(100).width(100).css("position","absolute").css("overflow","scroll");t.append('<div style="height: 400px; width: 400px;"></div>');e.ScrollH=t.height()-t[0].clientHeight;e.ScrollW=t.width()-t[0].clientWidth;t.empty();t.attr("style","");t.append('<span style="font-family: Verdana, Helvetica, Sans-Serif; font-size: 14px;"><strong>M</strong></span>');e.LetterW=t.children().first().width();t.remove()};e.eventStorage={};e.AssignGridContainers=function(t,n,r){r.$root=$(n);r.$topPanel=r.$root.find(".ngTopPanel");r.$groupPanel=r.$root.find(".ngGroupPanel");r.$headerContainer=r.$topPanel.find(".ngHeaderContainer");t.$headerContainer=r.$headerContainer;r.$headerScroller=r.$topPanel.find(".ngHeaderScroller");r.$headers=r.$headerScroller.children();r.$viewport=r.$root.find(".ngViewport");r.$canvas=r.$viewport.find(".ngCanvas");r.$footerPanel=r.$root.find(".ngFooterPanel");t.$watch(function(){return r.$viewport.scrollLeft()},function(e){return r.$headerContainer.scrollLeft(e)});e.UpdateGridLayout(t,r)};e.getRealWidth=function(e){var t=0;var n={visibility:"hidden",display:"block"};var r=e.parents().andSelf().not(":visible");$.swap(r[0],n,function(){t=e.outerWidth()});return t};e.UpdateGridLayout=function(t,n){var r=n.$viewport.scrollTop();n.elementDims.rootMaxW=n.$root.width();if(n.$root.is(":hidden")){n.elementDims.rootMaxW=e.getRealWidth(n.$root)}n.elementDims.rootMaxH=n.$root.height();n.refreshDomSizes();t.adjustScrollTop(r,true)};e.numberOfGrids=0;e.BuildStyles=function(t,n,r){var i=n.config.rowHeight,s=n.$styleSheet,o=n.gridId,u,a=t.columns,f=0;if(!s){s=$("#"+o);if(!s[0]){s=$("<style id='"+o+"' type='text/css' rel='stylesheet' />").appendTo(n.$root)}}s.empty();var l=t.totalRowWidth();u="."+o+" .ngCanvas { width: "+l+"px; }"+"."+o+" .ngRow { width: "+l+"px; }"+"."+o+" .ngCanvas { width: "+l+"px; }"+"."+o+" .ngHeaderScroller { width: "+(l+e.ScrollH+2)+"px}";for(var c=0;c<a.length;c++){var h=a[c];if(h.visible){var p=h.pinned?n.$viewport.scrollLeft()+f:f;u+="."+o+" .col"+c+" { width: "+h.width+"px; left: "+p+"px; height: "+i+"px }"+"."+o+" .colt"+c+" { width: "+h.width+"px; }";f+=h.width}}if(ng.utils.isIe){s[0].styleSheet.cssText=u}else{s[0].appendChild(document.createTextNode(u))}n.$styleSheet=s;if(r){t.adjustScrollLeft(n.$viewport.scrollLeft());e.digest(t)}};e.setColLeft=function(e,n,r){if(r.$styleSheet){var i=t[e.index];if(!i){i=t[e.index]=new RegExp(".col"+e.index+" { width: [0-9]+px; left: [0-9]+px")}var s=r.$styleSheet.html();var o=s.replace(i,".col"+e.index+" { width: "+e.width+"px; left: "+n+"px");if(ng.utils.isIe){setTimeout(function(){r.$styleSheet.html(o)})}else{r.$styleSheet.html(o)}}};e.setColLeft.immediate=1;e.RebuildGrid=function(t,n){e.UpdateGridLayout(t,n);if(n.config.maintainColumnRatios){n.configureColumnWidths()}t.adjustScrollLeft(n.$viewport.scrollLeft());e.BuildStyles(t,n,true)};e.digest=function(e){if(!e.$root.$$phase){e.$digest()}};e.ScrollH=17;e.ScrollW=17;e.LetterW=10;n();return e});ng.gridTemplate=function(){return'<div class="ngTopPanel" ng-class="{\'ui-widget-header\':jqueryUITheme, \'ui-corner-top\': jqueryUITheme}" ng-style="topPanelStyle()"><div class="ngGroupPanel" ng-show="showGroupPanel()" ng-style="groupPanelStyle()"><div class="ngGroupPanelDescription" ng-show="configGroups.length == 0">{{i18n.ngGroupPanelDescription}}</div><ul ng-show="configGroups.length > 0" class="ngGroupList"><li class="ngGroupItem" ng-repeat="group in configGroups"><span class="ngGroupElement"><span class="ngGroupName">{{group.displayName}}<span ng-click="removeGroup($index)" class="ngRemoveGroup">x</span></span><span ng-hide="$last" class="ngGroupArrow"></span></span></li></ul></div><div class="ngHeaderContainer" ng-style="headerStyle()"><div class="ngHeaderScroller" ng-style="headerScrollerStyle()" ng-header-row></div></div><div class="ngHeaderButton" ng-show="showColumnMenu || showFilter" ng-click="toggleShowMenu()"><div class="ngHeaderButtonArrow" ng-click=""></div></div><div ng-show="showMenu" class="ngColMenu"><div ng-show="showFilter"><input placeholder="{{i18n.ngSearchPlaceHolder}}" type="text" ng-model="filterText"/></div><div ng-show="showColumnMenu"><span class="ngMenuText">{{i18n.ngMenuText}}</span><ul class="ngColList"><li class="ngColListItem" ng-repeat="col in columns | ngColumns"><label><input ng-disabled="col.pinned" type="checkbox" class="ngColListCheckbox" ng-model="col.visible"/>{{col.displayName}}</label><a title="Group By" ng-class="col.groupedByClass()" ng-show="col.groupable && col.visible" ng-click="groupBy(col)"></a><span class="ngGroupingNumber" ng-show="col.groupIndex > 0">{{col.groupIndex}}</span></li></ul></div></div></div><div class="ngViewport" unselectable="on" ng-viewport ng-class="{\'ui-widget-content\': jqueryUITheme}" ng-style="viewportStyle()"><div class="ngCanvas" ng-style="canvasStyle()"><div ng-style="rowStyle(row)" ng-repeat="row in renderedRows" ng-click="row.toggleSelected($event)" class="ngRow" ng-class="row.alternatingRowClass()" ng-row></div></div></div><div class="ngFooterPanel" ng-class="{\'ui-widget-content\': jqueryUITheme, \'ui-corner-bottom\': jqueryUITheme}" ng-style="footerStyle()"><div class="ngTotalSelectContainer" ng-show="showFooter"><div class="ngFooterTotalItems" ng-class="{\'ngNoMultiSelect\': !multiSelect}" ><span class="ngLabel">{{i18n.ngTotalItemsLabel}} {{maxRows()}}</span><span ng-show="filterText.length > 0" class="ngLabel">({{i18n.ngShowingItemsLabel}} {{totalFilteredItemsLength()}})</span></div><div class="ngFooterSelectedItems" ng-show="multiSelect"><span class="ngLabel">{{i18n.ngSelectedItemsLabel}} {{selectedItems.length}}</span></div></div><div class="ngPagerContainer" style="float: right; margin-top: 10px;" ng-show="showFooter && enablePaging" ng-class="{\'ngNoMultiSelect\': !multiSelect}"><div style="float:left; margin-right: 10px;" class="ngRowCountPicker"><span style="float: left; margin-top: 3px;" class="ngLabel">{{i18n.ngPageSizeLabel}}</span><select style="float: left;height: 27px; width: 100px" ng-model="pagingOptions.pageSize" ><option ng-repeat="size in pagingOptions.pageSizes">{{size}}</option></select></div><div style="float:left; margin-right: 10px; line-height:25px;" class="ngPagerControl" style="float: left; min-width: 135px;"><button class="ngPagerButton" ng-click="pageToFirst()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerFirstTitle}}"><div class="ngPagerFirstTriangle"><div class="ngPagerFirstBar"></div></div></button><button class="ngPagerButton" ng-click="pageBackward()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerPrevTitle}}"><div class="ngPagerFirstTriangle ngPagerPrevTriangle"></div></button><input class="ngPagerCurrent" type="number" style="width:50px; height: 24px; margin-top: 1px; padding: 0px 4px;" ng-model="pagingOptions.currentPage"/><button class="ngPagerButton" ng-click="pageForward()" ng-disabled="cantPageForward()" title="{{i18n.ngPagerNextTitle}}"><div class="ngPagerLastTriangle ngPagerNextTriangle"></div></button><button class="ngPagerButton" ng-click="pageToLast()" ng-disabled="cantPageToLast()" title="{{i18n.ngPagerLastTitle}}"><div class="ngPagerLastTriangle"><div class="ngPagerLastBar"></div></div></button></div></div></div>'};ng.rowTemplate=function(){return'<div ng-style="{\'cursor\': row.cursor, \'z-index\': col.zIndex() }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngCell {{col.cellClass}}" ng-cell></div>'};ng.cellTemplate=function(){return'<div class="ngCellText" ng-class="col.colIndex()"><span ng-cell-text>{{COL_FIELD CUSTOM_FILTERS}}</span></div>'};ng.checkboxCellTemplate=function(){return'<div class="ngSelectionCell"><input tabindex="-1" class="ngSelectionCheckbox" type="checkbox" ng-checked="row.selected" /></div>'};ng.checkboxHeaderTemplate=function(){return'<input class="ngSelectionHeader" type="checkbox" ng-show="multiSelect" ng-model="allSelected" ng-change="toggleSelectAll(allSelected)"/>'};ng.editableCellTemplate=function(){return'<input ng-class="\'colt\' + col.index" ng-input="COL_FIELD" />'};ng.cellEditTemplate=function(){return'<div ng-cell-has-focus ng-dblclick="editCell()"><div ng-if="!isFocused">DISPLAY_CELL_TEMPLATE</div><div ng-if="isFocused">EDITABLE_CELL_TEMPLATE</div></div>'};ng.aggregateTemplate=function(){return'<div ng-click="row.toggleExpand()" ng-style="{\'left\': row.offsetleft}" class="ngAggregate"><span class="ngAggregateText">{{row.label CUSTOM_FILTERS}} ({{row.totalChildren()}} {{AggItemsLabel}})</span><div class="{{row.aggClass()}}"></div></div>'};ng.headerRowTemplate=function(){return'<div ng-style="{\'z-index\': col.zIndex(), height: col.headerRowHeight}" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngHeaderCell" ng-header-cell></div>'};ng.headerCellTemplate=function(){return'<div class="ngHeaderSortColumn {{col.headerClass}}" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !noSortVisible }"><div ng-click="col.sort($event)" ng-class="\'colt\' + col.index" class="ngHeaderText">{{col.displayName}}</div><div class="ngSortButtonDown" ng-show="col.showSortButtonDown()"></div><div class="ngSortButtonUp" ng-show="col.showSortButtonUp()"></div><div class="ngSortPriority">{{col.sortPriority}}</div><div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click="togglePin(col)" ng-show="col.pinnable"></div></div><div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>'};ng.Aggregate=function(e,t,n){var r=this;r.rowIndex=0;r.offsetTop=r.rowIndex*n;r.entity=e;r.label=e.gLabel;r.field=e.gField;r.depth=e.gDepth;r.parent=e.parent;r.children=e.children;r.aggChildren=e.aggChildren;r.aggIndex=e.aggIndex;r.collapsed=true;r.isAggRow=true;r.offsetleft=e.gDepth*25;r.aggLabelFilter=e.aggLabelFilter;r.toggleExpand=function(){r.collapsed=r.collapsed?false:true;if(r.orig){r.orig.collapsed=r.collapsed}r.notifyChildren()};r.setExpand=function(e){r.collapsed=e;r.notifyChildren()};r.notifyChildren=function(){var e=Math.max(t.aggCache.length,r.children.length);for(var n=0;n<e;n++){if(r.aggChildren[n]){r.aggChildren[n].entity[c]=r.collapsed;if(r.collapsed){r.aggChildren[n].setExpand(r.collapsed)}}if(r.children[n]){r.children[n][c]=r.collapsed}if(n>r.aggIndex&&t.aggCache[n]){var i=t.aggCache[n];var s=30*r.children.length;i.offsetTop=r.collapsed?i.offsetTop-s:i.offsetTop+s}}t.renderedChange()};r.aggClass=function(){return r.collapsed?"ngAggArrowCollapsed":"ngAggArrowExpanded"};r.totalChildren=function(){if(r.aggChildren.length>0){var e=0;var t=function(n){if(n.aggChildren.length>0){angular.forEach(n.aggChildren,function(e){t(e)})}else{e+=n.children.length}};t(r);return e}else{return r.children.length}};r.copy=function(){var e=new ng.Aggregate(r.entity,t,n);e.orig=r;return e}};ng.EventProvider=function(t,n,r){var i=this;i.colToMove=undefined;i.groupToMove=undefined;i.assignEvents=function(){if(t.config.jqueryUIDraggable&&!t.config.enablePinning){t.$groupPanel.droppable({addClasses:false,drop:function(e){i.onGroupDrop(e)}});n.$evalAsync(i.setDraggables)}else{t.$groupPanel.on("mousedown",i.onGroupMouseDown).on("dragover",i.dragOver).on("drop",i.onGroupDrop);t.$headerScroller.on("mousedown",i.onHeaderMouseDown).on("dragover",i.dragOver);if(t.config.enableColumnReordering&&!t.config.enablePinning){t.$headerScroller.on("drop",i.onHeaderDrop)}if(t.config.enableRowReordering){t.$viewport.on("mousedown",i.onRowMouseDown).on("dragover",i.dragOver).on("drop",i.onRowDrop)}}n.$watch("columns",i.setDraggables,true)};i.dragStart=function(e){e.dataTransfer.setData("text","")};i.dragOver=function(e){e.preventDefault()};i.setDraggables=function(){if(!t.config.jqueryUIDraggable){var e=t.$root.find(".ngHeaderSortColumn");angular.forEach(e,function(e){e.setAttribute("draggable","true");if(e.addEventListener){e.addEventListener("dragstart",i.dragStart)}});if(navigator.userAgent.indexOf("MSIE")!=-1){t.$root.find(".ngHeaderSortColumn").bind("selectstart",function(){this.dragDrop();return false})}}else{t.$root.find(".ngHeaderSortColumn").draggable({helper:"clone",appendTo:"body",stack:"div",addClasses:false,start:function(e){i.onHeaderMouseDown(e)}}).droppable({drop:function(e){i.onHeaderDrop(e)}})}};i.onGroupMouseDown=function(e){var n=$(e.target);if(n[0].className!="ngRemoveGroup"){var r=angular.element(n).scope();if(r){if(!t.config.jqueryUIDraggable){n.attr("draggable","true");if(this.addEventListener){this.addEventListener("dragstart",i.dragStart)}if(navigator.userAgent.indexOf("MSIE")!=-1){n.bind("selectstart",function(){this.dragDrop();return false})}}i.groupToMove={header:n,groupName:r.group,index:r.$index}}}else{i.groupToMove=undefined}};i.onGroupDrop=function(e){e.stopPropagation();var r;var s;if(i.groupToMove){r=$(e.target).closest(".ngGroupElement");if(r.context.className=="ngGroupPanel"){n.configGroups.splice(i.groupToMove.index,1);n.configGroups.push(i.groupToMove.groupName)}else{s=angular.element(r).scope();if(s){if(i.groupToMove.index!=s.$index){n.configGroups.splice(i.groupToMove.index,1);n.configGroups.splice(s.$index,0,i.groupToMove.groupName)}}}i.groupToMove=undefined;t.fixGroupIndexes()}else if(i.colToMove){if(n.configGroups.indexOf(i.colToMove.col)==-1){r=$(e.target).closest(".ngGroupElement");if(r.context.className=="ngGroupPanel"||r.context.className=="ngGroupPanelDescription ng-binding"){n.groupBy(i.colToMove.col)}else{s=angular.element(r).scope();if(s){n.removeGroup(s.$index)}}}i.colToMove=undefined}if(!n.$$phase){n.$apply()}};i.onHeaderMouseDown=function(e){var t=$(e.target).closest(".ngHeaderSortColumn");var n=angular.element(t).scope();if(n){i.colToMove={header:t,col:n.col}}};i.onHeaderDrop=function(e){if(!i.colToMove){return}var s=$(e.target).closest(".ngHeaderSortColumn");var o=angular.element(s).scope();if(o){if(i.colToMove.col==o.col){return}n.columns.splice(i.colToMove.col.index,1);n.columns.splice(o.col.index,0,i.colToMove.col);t.fixColumnIndexes();r.BuildStyles(n,t,true);i.colToMove=undefined}};i.onRowMouseDown=function(e){var t=$(e.target).closest(".ngRow");var n=angular.element(t).scope();if(n){t.attr("draggable","true");r.eventStorage.rowToMove={targetRow:t,scope:n}}};i.onRowDrop=function(e){var n=$(e.target).closest(".ngRow");var i=angular.element(n).scope();if(i){var s=r.eventStorage.rowToMove;if(s.scope.row==i.row){return}t.changeRowOrder(s.scope.row,i.row);t.searchProvider.evalFilter();r.eventStorage.rowToMove=undefined;r.digest(i.$root)}};i.assignGridEventHandlers=function(){if(t.config.tabIndex===-1){t.$viewport.attr("tabIndex",r.numberOfGrids);r.numberOfGrids++}else{t.$viewport.attr("tabIndex",t.config.tabIndex)}$(e).resize(function(){r.RebuildGrid(n,t)})};i.assignGridEventHandlers();i.assignEvents()};ng.Column=function(e,t,n,r){var i=this,s=e.colDef,a=500,f=0,l=null;i.width=s.width;i.groupIndex=0;i.isGroupedBy=false;i.minWidth=!s.minWidth?50:s.minWidth;i.maxWidth=!s.maxWidth?9e3:s.maxWidth;i.enableCellEdit=e.enableCellEdit||s.enableCellEdit;i.headerRowHeight=e.headerRowHeight;i.displayName=s.displayName||s.field;i.index=e.index;i.isAggCol=e.isAggCol;i.cellClass=s.cellClass;i.sortPriority=undefined;i.zIndex=function(){return i.pinned?5:0};i.cellFilter=s.cellFilter?s.cellFilter:"";i.field=s.field;i.aggLabelFilter=s.cellFilter||s.aggLabelFilter;i.visible=ng.utils.isNullOrUndefined(s.visible)||s.visible;i.sortable=false;i.resizable=false;i.pinnable=false;i.pinned=s.pinned;i.originalIndex=i.index;i.groupable=ng.utils.isNullOrUndefined(s.groupable)||s.groupable;if(e.enableSort){i.sortable=ng.utils.isNullOrUndefined(s.sortable)||s.sortable}if(e.enableResize){i.resizable=ng.utils.isNullOrUndefined(s.resizable)||s.resizable}if(e.enablePinning){i.pinnable=ng.utils.isNullOrUndefined(s.pinnable)||s.pinnable}i.sortDirection=undefined;i.sortingAlgorithm=s.sortFn;i.headerClass=s.headerClass;i.cursor=i.sortable?"pointer":"default";i.headerCellTemplate=s.headerCellTemplate||ng.headerCellTemplate();i.cellTemplate=s.cellTemplate||ng.cellTemplate().replace(p,i.cellFilter?"|"+i.cellFilter:"");if(i.enableCellEdit){i.cellEditTemplate=ng.cellEditTemplate();i.editableCellTemplate=s.editableCellTemplate||ng.editableCellTemplate()}if(s.cellTemplate&&!g.test(s.cellTemplate)){i.cellTemplate=$.ajax({type:"GET",url:s.cellTemplate,async:false}).responseText}if(i.enableCellEdit&&s.editableCellTemplate&&!g.test(s.editableCellTemplate)){i.editableCellTemplate=$.ajax({type:"GET",url:s.editableCellTemplate,async:false}).responseText}if(s.headerCellTemplate&&!g.test(s.headerCellTemplate)){i.headerCellTemplate=$.ajax({type:"GET",url:s.headerCellTemplate,async:false}).responseText}i.colIndex=function(){return"col"+i.index+" colt"+i.index};i.groupedByClass=function(){return i.isGroupedBy?"ngGroupedByIcon":"ngGroupIcon"};i.toggleVisible=function(){i.visible=!i.visible};i.showSortButtonUp=function(){return i.sortable?i.sortDirection===u:i.sortable};i.showSortButtonDown=function(){return i.sortable?i.sortDirection===o:i.sortable};i.noSortVisible=function(){return!i.sortDirection};i.sort=function(t){if(!i.sortable){return true}var n=i.sortDirection===o?u:o;i.sortDirection=n;e.sortCallback(i,t);return false};i.gripClick=function(){f++;if(f===1){l=setTimeout(function(){f=0},a)}else{clearTimeout(l);e.resizeOnDataCallback(i);f=0}};i.gripOnMouseDown=function(e){if(e.ctrlKey&&!i.pinned){i.toggleVisible();r.BuildStyles(t,n);return true}e.target.parentElement.style.cursor="col-resize";i.startMousePosition=e.clientX;i.origWidth=i.width;$(document).mousemove(i.onMouseMove);$(document).mouseup(i.gripOnMouseUp);return false};i.onMouseMove=function(e){var s=e.clientX-i.startMousePosition;var o=s+i.origWidth;i.width=o<i.minWidth?i.minWidth:o>i.maxWidth?i.maxWidth:o;r.BuildStyles(t,n);return false};i.gripOnMouseUp=function(e){$(document).off("mousemove",i.onMouseMove);$(document).off("mouseup",i.gripOnMouseUp);e.target.parentElement.style.cursor="default";t.adjustScrollLeft(0);r.digest(t);return false};i.copy=function(){var s=new ng.Column(e,t,n,r);s.isClone=true;s.orig=i;return s};i.setVars=function(e){i.orig=e;i.width=e.width;i.groupIndex=e.groupIndex;i.isGroupedBy=e.isGroupedBy;i.displayName=e.displayName;i.index=e.index;i.isAggCol=e.isAggCol;i.cellClass=e.cellClass;i.cellFilter=e.cellFilter;i.field=e.field;i.aggLabelFilter=e.aggLabelFilter;i.visible=e.visible;i.sortable=e.sortable;i.resizable=e.resizable;i.pinnable=e.pinnable;i.pinned=e.pinned;i.originalIndex=e.originalIndex;i.sortDirection=e.sortDirection;i.sortingAlgorithm=e.sortingAlgorithm;i.headerClass=e.headerClass;i.headerCellTemplate=e.headerCellTemplate;i.cellTemplate=e.cellTemplate;i.cellEditTemplate=e.cellEditTemplate}};ng.Dimension=function(e){this.outerHeight=null;this.outerWidth=null;$.extend(this,e)};ng.Footer=function(e,t){e.maxRows=function(){var n=Math.max(e.pagingOptions.totalServerItems,t.data.length);return n};e.multiSelect=t.config.enableRowSelection&&t.config.multiSelect;e.selectedItemCount=t.selectedItemCount;e.maxPages=function(){return Math.ceil(e.maxRows()/e.pagingOptions.pageSize)};e.pageForward=function(){var t=e.pagingOptions.currentPage;if(e.pagingOptions.totalServerItems>0){e.pagingOptions.currentPage=Math.min(t+1,e.maxPages())}else{e.pagingOptions.currentPage++}};e.pageBackward=function(){var t=e.pagingOptions.currentPage;e.pagingOptions.currentPage=Math.max(t-1,1)};e.pageToFirst=function(){e.pagingOptions.currentPage=1};e.pageToLast=function(){var t=e.maxPages();e.pagingOptions.currentPage=t};e.cantPageForward=function(){var n=e.pagingOptions.currentPage;var r=e.maxPages();if(e.pagingOptions.totalServerItems>0){return!(n<r)}else{return t.data.length<1}};e.cantPageToLast=function(){if(e.pagingOptions.totalServerItems>0){return e.cantPageForward()}else{return true}};e.cantPageBackward=function(){var t=e.pagingOptions.currentPage;return!(t>1)}};ng.RowFactory=function(e,t,n){var r=this;r.aggCache={};r.parentCache=[];r.dataChanged=true;r.parsedData=[];r.rowConfig={};r.selectionService=t.selectionService;r.rowHeight=30;r.numberOfAggregates=0;r.groupedData=undefined;r.rowHeight=e.config.rowHeight;r.rowConfig={enableRowSelection:e.config.enableRowSelection,rowClasses:e.config.rowClasses,selectedItems:t.selectedItems,selectWithCheckboxOnly:e.config.selectWithCheckboxOnly,beforeSelectionChangeCallback:e.config.beforeSelectionChange,afterSelectionChangeCallback:e.config.afterSelectionChange,jqueryUITheme:e.config.jqueryUITheme,enableCellSelection:e.config.enableCellSelection,rowHeight:e.config.rowHeight};r.renderedRange=new ng.Range(0,e.minRowsToRender()+i);r.buildEntityRow=function(e,t){return new ng.Row(e,r.rowConfig,r.selectionService,t)};r.buildAggregateRow=function(e,t){var n=r.aggCache[e.aggIndex];if(!n){n=new ng.Aggregate(e,r,r.rowConfig.rowHeight);r.aggCache[e.aggIndex]=n}n.rowIndex=t;n.offsetTop=t*r.rowConfig.rowHeight;return n};r.UpdateViewableRange=function(e){r.renderedRange=e;r.renderedChange()};r.filteredRowsChanged=function(){if(e.lateBoundColumns&&e.filteredRows.length>0){e.config.columnDefs=undefined;e.buildColumns();e.lateBoundColumns=false;t.$evalAsync(function(){t.adjustScrollLeft(0)})}r.dataChanged=true;if(e.config.groups.length>0){r.getGrouping(e.config.groups)}r.UpdateViewableRange(r.renderedRange)};r.renderedChange=function(){if(!r.groupedData||e.config.groups.length<1){r.renderedChangeNoGroups();e.refreshDomSizes();return}r.wasGrouped=true;r.parentCache=[];var t=0;var n=r.parsedData.filter(function(e,n){if(e.isAggRow){if(e.parent&&e.parent.collapsed){return false}return true}if(!e[c]){e.rowIndex=t++}return!e[c]});r.totalRows=n.length;var i=[];for(var t=r.renderedRange.topRow;t<r.renderedRange.bottomRow;t++){if(n[t]){n[t].offsetTop=t*e.config.rowHeight;i.push(n[t])}}e.setRenderedRows(i)};r.renderedChangeNoGroups=function(){var t=[];for(var n=r.renderedRange.topRow;n<r.renderedRange.bottomRow;n++){if(e.filteredRows[n]){e.filteredRows[n].rowIndex=n;e.filteredRows[n].offsetTop=n*e.config.rowHeight;t.push(e.filteredRows[n])}}e.setRenderedRows(t)};r.fixRowCache=function(){var t=e.data.length;var n=t-e.rowCache.length;if(n<0){e.rowCache.length=e.rowMap.length=t}else{for(var r=e.rowCache.length;r<t;r++){e.rowCache[r]=e.rowFactory.buildEntityRow(e.data[r],r)}}};r.parseGroupData=function(e){if(e.values){for(var t=0;t<e.values.length;t++){r.parentCache[r.parentCache.length-1].children.push(e.values[t]);r.parsedData.push(e.values[t])}}else{for(var n in e){if(n==f||n==l||n==h){continue}else if(e.hasOwnProperty(n)){var i=r.buildAggregateRow({gField:e[f],gLabel:n,gDepth:e[l],isAggRow:true,_ng_hidden_:false,children:[],aggChildren:[],aggIndex:r.numberOfAggregates,aggLabelFilter:e[h].aggLabelFilter},0);r.numberOfAggregates++;i.parent=r.parentCache[i.depth-1];if(i.parent){i.parent.collapsed=false;i.parent.aggChildren.push(i)}r.parsedData.push(i);r.parentCache[i.depth]=i;r.parseGroupData(e[n])}}}};r.getGrouping=function(i){r.aggCache=[];r.numberOfAggregates=0;r.groupedData={};var s=e.filteredRows,o=i.length,u=t.columns;for(var a=0;a<s.length;a++){var p=s[a].entity;if(!p)return;s[a][c]=true;var d=r.groupedData;for(var v=0;v<i.length;v++){var m=i[v];var g=u.filter(function(e){return e.field==m})[0];var y=ng.utils.evalProperty(p,m);y=y?y.toString():"null";if(!d[y]){d[y]={}}if(!d[f]){d[f]=m}if(!d[l]){d[l]=v}if(!d[h]){d[h]=g}d=d[y]}if(!d.values){d.values=[]}d.values.push(s[a])}for(var b=0;b<i.length;b++){if(!u[b].isAggCol&&b<=o){u.splice(0,0,new ng.Column({colDef:{field:"",width:25,sortable:false,resizable:false,headerCellTemplate:'<div class="ngAggHeader"></div>',pinned:e.config.pinSelectionCheckbox},isAggCol:true,headerRowHeight:e.config.headerRowHeight}))}}n.BuildStyles(t,e,true);e.fixColumnIndexes();t.adjustScrollLeft(0);r.parsedData.length=0;r.parseGroupData(r.groupedData);r.fixRowCache()};if(e.config.groups.length>0&&e.filteredRows.length>0){r.getGrouping(e.config.groups)}};ng.Grid=function(t,n,r,o,u){var a={aggregateTemplate:undefined,afterSelectionChange:function(){},beforeSelectionChange:function(){return true},checkboxCellTemplate:undefined,checkboxHeaderTemplate:undefined,columnDefs:undefined,data:[],dataUpdated:function(){},enableCellEdit:false,enableCellSelection:false,enableColumnResize:false,enableColumnReordering:false,enableColumnHeavyVirt:false,enablePaging:false,enablePinning:false,enableRowReordering:false,enableRowSelection:true,enableSorting:true,excludeProperties:[],filterOptions:{filterText:"",useExternalFilter:false},footerRowHeight:55,groups:[],headerRowHeight:30,headerRowTemplate:undefined,jqueryUIDraggable:false,jqueryUITheme:false,keepLastSelected:true,maintainColumnRatios:undefined,multiSelect:true,pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,totalServerItems:0,currentPage:1},pinSelectionCheckbox:false,plugins:[],rowHeight:30,rowTemplate:undefined,selectedItems:[],selectWithCheckboxOnly:false,showColumnMenu:false,showFilter:false,showFooter:false,showGroupPanel:false,showSelectionCheckbox:false,sortInfo:undefined,tabIndex:-1,useExternalSorting:false,i18n:"en",virtualizationThreshold:50},f=this;f.maxCanvasHt=0;f.config=$.extend(a,e.ngGrid.config,n);f.config.showSelectionCheckbox=f.config.showSelectionCheckbox&&f.config.enableColumnHeavyVirt===false;f.config.enablePinning=f.config.enablePinning&&f.config.enableColumnHeavyVirt===false;f.config.selectWithCheckboxOnly=f.config.selectWithCheckboxOnly&&f.config.showSelectionCheckbox!==false;f.config.pinSelectionCheckbox=f.config.enablePinning;if(typeof n.columnDefs=="string"){f.config.columnDefs=t.$eval(n.columnDefs)}f.rowCache=[];f.rowMap=[];f.gridId="ng"+ng.utils.newId();f.$root=null;f.$groupPanel=null;f.$topPanel=null;f.$headerContainer=null;f.$headerScroller=null;f.$headers=null;f.$viewport=null;f.$canvas=null;f.rootDim=f.config.gridDim;f.sortInfo=f.config.sortInfo;f.data=[];f.lateBindColumns=false;f.filteredRows=[];if(typeof f.config.data=="object"){f.data=f.config.data}f.calcMaxCanvasHeight=function(){return f.config.groups.length>0?f.rowFactory.parsedData.filter(function(e){return!e[c]}).length*f.config.rowHeight:f.filteredRows.length*f.config.rowHeight};f.elementDims={scrollW:0,scrollH:0,rowIndexCellW:25,rowSelectedCellW:25,rootMaxW:0,rootMaxH:0};f.setRenderedRows=function(e){t.renderedRows.length=e.length;for(var n=0;n<e.length;n++){if(!t.renderedRows[n]||e[n].isAggRow||t.renderedRows[n].isAggRow){t.renderedRows[n]=e[n].copy();t.renderedRows[n].collapsed=e[n].collapsed;if(!e[n].isAggRow){t.renderedRows[n].setVars(e[n])}}else{t.renderedRows[n].setVars(e[n])}t.renderedRows[n].rowIndex=e[n].rowIndex;t.renderedRows[n].offsetTop=e[n].offsetTop;e[n].renderedRowIndex=n}f.refreshDomSizes();t.$emit("ngGridEventRows",e)};f.minRowsToRender=function(){var e=t.viewportDimHeight()||1;return Math.floor(e/f.config.rowHeight)};f.refreshDomSizes=function(){var e=new ng.Dimension;e.outerWidth=f.elementDims.rootMaxW;e.outerHeight=f.elementDims.rootMaxH;f.rootDim=e;f.maxCanvasHt=f.calcMaxCanvasHeight()};f.buildColumnDefsFromData=function(){f.config.columnDefs=[];var e=f.data[0];if(!e){f.lateBoundColumns=true;return}ng.utils.forIn(e,function(e,t){if(f.config.excludeProperties.indexOf(t)==-1){f.config.columnDefs.push({field:t})}})};f.buildColumns=function(){var e=f.config.columnDefs,n=[];if(!e){f.buildColumnDefsFromData();e=f.config.columnDefs}if(f.config.showSelectionCheckbox){n.push(new ng.Column({colDef:{field:"✔",width:f.elementDims.rowSelectedCellW,sortable:false,resizable:false,groupable:false,headerCellTemplate:t.checkboxHeaderTemplate,cellTemplate:t.checkboxCellTemplate,pinned:f.config.pinSelectionCheckbox},index:0,headerRowHeight:f.config.headerRowHeight,sortCallback:f.sortData,resizeOnDataCallback:f.resizeOnData,enableResize:f.config.enableColumnResize,enableSort:f.config.enableSorting},t,f,o,u))}if(e.length>0){var r=f.config.showSelectionCheckbox?f.config.groups.length+1:f.config.groups.length;t.configGroups.length=0;angular.forEach(e,function(e,i){i+=r;var s=new ng.Column({colDef:e,index:i,headerRowHeight:f.config.headerRowHeight,sortCallback:f.sortData,resizeOnDataCallback:f.resizeOnData,enableResize:f.config.enableColumnResize,enableSort:f.config.enableSorting,enablePinning:f.config.enablePinning,enableCellEdit:f.config.enableCellEdit},t,f,o);var u=f.config.groups.indexOf(e.field);if(u!=-1){s.isGroupedBy=true;t.configGroups.splice(u,0,s);s.groupIndex=t.configGroups.length}n.push(s)});t.columns=n}};f.configureColumnWidths=function(){var e=f.config.columnDefs;var n=f.config.showSelectionCheckbox?t.configGroups.length+1:t.configGroups.length;var r=e.length+n,i=[],s=[],u=0,a=0;a+=f.config.showSelectionCheckbox?25:0;angular.forEach(e,function(e,r){r+=n;var o=false,l=undefined;if(ng.utils.isNullOrUndefined(e.width)){e.width="*"}else{o=isNaN(e.width)?ng.utils.endsWith(e.width,"%"):false;l=o?e.width:parseInt(e.width,10)}if(isNaN(l)){l=e.width;if(l=="auto"){t.columns[r].width=e.minWidth;a+=t.columns[r].width;var c=t.columns[r];t.$evalAsync(function(){f.resizeOnData(c,true)});return}else if(l.indexOf("*")!=-1){u+=l.length;e.index=r;i.push(e);return}else if(o){e.index=r;s.push(e);return}else{throw'unable to parse column width, use percentage ("10%","20%", etc...) or "*" to use remaining width of grid'}}else{a+=t.columns[r].width=parseInt(e.width,10)}});if(i.length>0){f.config.maintainColumnRatios===false?angular.noop():f.config.maintainColumnRatios=true;var l=f.rootDim.outerWidth-a;var c=Math.floor(l/u);angular.forEach(i,function(e){var n=e.width.length;t.columns[e.index].width=c*n;if(e.index+1==r){var i=2;if(f.maxCanvasHt>t.viewportDimHeight()){i+=o.ScrollW}t.columns[e.index].width-=i}a+=t.columns[e.index].width})}if(s.length>0){angular.forEach(s,function(e){var n=e.width;t.columns[e.index].width=Math.floor(f.rootDim.outerWidth*(parseInt(n.slice(0,-1),10)/100))})}};f.init=function(){t.selectionService=new ng.SelectionService(f,t);t.domAccessProvider=new ng.DomAccessProvider(f);f.rowFactory=new ng.RowFactory(f,t,o);f.searchProvider=new ng.SearchProvider(t,f,u);f.styleProvider=new ng.StyleProvider(t,f,o);t.$watch("configGroups",function(e){var n=[];angular.forEach(e,function(e){n.push(e.field||e)});f.config.groups=n;f.rowFactory.filteredRowsChanged();t.$emit("ngGridEventGroups",e)},true);t.$watch("columns",function(e){o.BuildStyles(t,f,true);t.$emit("ngGridEventColumns",e)},true);t.$watch(function(){return n.i18n},function(e){ng.utils.seti18n(t,e)});f.maxCanvasHt=f.calcMaxCanvasHeight();if(f.config.sortInfo&&t.columns.length){f.config.sortInfo.columns=t.columns.filter(function(e){if(f.config.sortInfo.field.indexOf(e.field)!=-1){return true}return false});f.config.sortInfo.column.sortDirection=f.config.sortInfo.direction.toUpperCase();f.sortData(f.config.sortInfo.columns)}};f.resizeOnData=function(e){var n=e.minWidth;var r=ng.utils.getElementsByClassName("col"+e.index);angular.forEach(r,function(e,t){var r;if(t===0){var i=$(e).find(".ngHeaderText");r=ng.utils.visualLength(i)+10}else{var s=$(e).find(".ngCellText");r=ng.utils.visualLength(s)+10}if(r>n){n=r}});e.width=e.longest=Math.min(e.maxWidth,n+7);o.BuildStyles(t,f,true)};f.lastSortedColumns=[];f.changeRowOrder=function(e,n){var r=f.rowCache.indexOf(e);var i=f.rowCache.indexOf(n);f.rowCache.splice(r,1);f.rowCache.splice(i,0,e);t.$emit("ngGridEventChangeOrder",f.rowCache)};f.sortData=function(e,n){if(n.shiftKey&&f.config.sortInfo){var i=f.config.sortInfo.columns.indexOf(e);if(i===-1){if(f.config.sortInfo.columns.length==1){f.config.sortInfo.columns[0].sortPriority=1}f.config.sortInfo.columns.push(e);e.sortPriority=f.config.sortInfo.columns.length;f.config.sortInfo.fields.push(e.field);f.config.sortInfo.directions.push(e.sortDirection);f.lastSortedColumns.push(e)}else{f.config.sortInfo.directions[i]=e.sortDirection}}else{var s=$.isArray(e);f.config.sortInfo={columns:[],fields:[],directions:[]};var o=function(e){f.config.sortInfo.columns.push(e);f.config.sortInfo.fields.push(e.field);f.config.sortInfo.directions.push(e.sortDirection);f.lastSortedColumns.push(e)};if(s){f.clearSortingData();angular.forEach(e,function(e,t){e.sortPriority=t+1;o(e)})}else{f.clearSortingData(e);e.sortPriority=undefined;o(e)}}if(!f.config.useExternalSorting){var u=f.data.slice(0);angular.forEach(u,function(e,t){e.preSortSelected=f.rowCache[f.rowMap[t]].selected;e.preSortIndex=t});r.Sort(f.config.sortInfo,u);angular.forEach(u,function(e,t){f.rowCache[t].entity=e;f.rowCache[t].selected=e.preSortSelected;f.rowMap[e.preSortIndex]=t;delete e.preSortSelected;delete e.preSortIndex})}f.searchProvider.evalFilter();t.$emit("ngGridEventSorted",e)};f.clearSortingData=function(e){if(!e){angular.forEach(f.lastSortedColumns,function(e){e.sortDirection="";e.sortPriority=null});f.lastSortedColumns=[]}else{angular.forEach(f.lastSortedColumns,function(t){if(e.index!=t.index){t.sortDirection="";t.sortPriority=null}});f.lastSortedColumns[0]=e;f.lastSortedColumns.length=1}};f.fixColumnIndexes=function(){for(var e=0;e<t.columns.length;e++){if(t.columns[e].visible){t.columns[e].index=e}}};f.fixGroupIndexes=function(){angular.forEach(t.configGroups,function(e,t){e.groupIndex=t+1})};t.elementsNeedMeasuring=true;t.columns=[];t.renderedRows=[];t.renderedColumns=[];t.headerRow=null;t.rowHeight=f.config.rowHeight;t.jqueryUITheme=f.config.jqueryUITheme;t.showSelectionCheckbox=f.config.showSelectionCheckbox;t.enableCellSelection=f.config.enableCellSelection;t.footer=null;t.selectedItems=f.config.selectedItems;t.multiSelect=f.config.multiSelect;t.showFooter=f.config.showFooter;t.footerRowHeight=t.showFooter?f.config.footerRowHeight:0;t.showColumnMenu=f.config.showColumnMenu;t.showMenu=false;t.configGroups=[];t.enablePaging=f.config.enablePaging;t.pagingOptions=f.config.pagingOptions;var l=function(e){var n=f.config[e];if(n&&!g.test(n)){t[e]=$.ajax({type:"GET",url:n,async:false}).responseText}else if(n){t[e]=f.config[e]}else{t[e]=ng[e]()}};l("rowTemplate");l("aggregateTemplate");l("headerRowTemplate");l("checkboxCellTemplate");l("checkboxHeaderTemplate");t.i18n={};ng.utils.seti18n(t,f.config.i18n);t.adjustScrollLeft=function(e){var n=0,r=0,i=t.columns.length,s=[],u=!f.config.enableColumnHeavyVirt;var a=0;var l=function(e){if(u){s.push(e)}else{if(!t.renderedColumns[a]){t.renderedColumns[a]=e.copy()}else{t.renderedColumns[a].setVars(e)}}a++};for(var c=0;c<i;c++){var h=t.columns[c];if(h.visible){var p=h.width+n;if(h.pinned){l(h);var d=c>0?e+r:e;o.setColLeft(h,d,f);r+=h.width}else{if(p>=e){if(n<=e+f.rootDim.outerWidth){l(h)}}}n+=h.width}}if(u){t.renderedColumns=s}};f.prevScrollTop=0;f.prevScrollIndex=0;t.adjustScrollTop=function(e,n){if(f.prevScrollTop===e&&!n){return}if(e>0&&f.$viewport[0].scrollHeight-e<=f.$viewport.outerHeight()){t.$emit("ngGridEventScroll")}var r=Math.floor(e/f.config.rowHeight);var o;if(f.filteredRows.length>f.config.virtualizationThreshold){if(f.prevScrollTop<e&&r<f.prevScrollIndex+s){return}if(f.prevScrollTop>e&&r>f.prevScrollIndex-s){return}o=new ng.Range(Math.max(0,r-i),r+f.minRowsToRender()+i)}else{var u=t.configGroups.length>0?f.rowFactory.parsedData.length:f.data.length;o=new ng.Range(0,Math.max(u,f.minRowsToRender()+i))}f.prevScrollTop=e;f.rowFactory.UpdateViewableRange(o);f.prevScrollIndex=r};t.toggleShowMenu=function(){t.showMenu=!t.showMenu};t.toggleSelectAll=function(e){t.selectionService.toggleSelectAll(e)};t.totalFilteredItemsLength=function(){return f.filteredRows.length};t.showGroupPanel=function(){return f.config.showGroupPanel};t.topPanelHeight=function(){return f.config.showGroupPanel===true?f.config.headerRowHeight+31:f.config.headerRowHeight};t.viewportDimHeight=function(){return Math.max(0,f.rootDim.outerHeight-t.topPanelHeight()-t.footerRowHeight-2)};t.groupBy=function(e){if(!e.sortDirection)e.sort({shiftKey:false});if(f.data.length<1||!e.groupable||!e.field){return}var n=t.configGroups.indexOf(e);if(n==-1){e.isGroupedBy=true;t.configGroups.push(e);e.groupIndex=t.configGroups.length}else{t.removeGroup(n)}f.$viewport.scrollTop(0);o.digest(t)};t.removeGroup=function(e){var n=t.columns.filter(function(t){return t.groupIndex==e+1})[0];n.isGroupedBy=false;n.groupIndex=0;if(t.columns[e].isAggCol){t.columns.splice(e,1);t.configGroups.splice(e,1);f.fixGroupIndexes()}if(t.configGroups.length===0){f.fixColumnIndexes();o.digest(t)}t.adjustScrollLeft(0)};t.togglePin=function(e){var n=e.index;var r=0;for(var i=0;i<t.columns.length;i++){if(!t.columns[i].pinned){break}r++}if(e.pinned){r=Math.max(e.originalIndex,r-1)}e.pinned=!e.pinned;t.columns.splice(n,1);t.columns.splice(r,0,e);f.fixColumnIndexes();o.BuildStyles(t,f,true);f.$viewport.scrollLeft(f.$viewport.scrollLeft()-e.width)};t.totalRowWidth=function(){var e=0,n=t.columns;for(var r=0;r<n.length;r++){if(n[r].visible){e+=n[r].width}}return e};t.headerScrollerDim=function(){var e=t.viewportDimHeight(),n=f.maxCanvasHt,r=n>e,i=new ng.Dimension;i.autoFitHeight=true;i.outerWidth=t.totalRowWidth();if(r){i.outerWidth+=f.elementDims.scrollW}else if(n-e<=f.elementDims.scrollH){i.outerWidth+=f.elementDims.scrollW}return i};f.init()};ng.Range=function(e,t){this.topRow=e;this.bottomRow=t};ng.Row=function(e,t,n,r){var i=this,s=t.enableRowSelection;i.jqueryUITheme=t.jqueryUITheme;i.rowClasses=t.rowClasses;i.entity=e;i.selectionService=n;i.selected=n.getSelection(e);i.cursor=s?"pointer":"default";i.setSelection=function(e){i.selectionService.setSelection(i,e);i.selectionService.lastClickedRow=i};i.continueSelection=function(e){i.selectionService.ChangeSelection(i,e)};i.ensureEntity=function(e){if(i.entity!=e){i.entity=e;i.selected=i.selectionService.getSelection(i.entity)}};i.toggleSelected=function(e){if(!s&&!t.enableCellSelection){return true}var n=e.target||e;if(n.type=="checkbox"&&n.parentElement.className!="ngSelectionCell ng-scope"){return true}if(t.selectWithCheckboxOnly&&n.type!="checkbox"){i.selectionService.lastClickedRow=i;return true}else{if(i.beforeSelectionChange(i,e)){i.continueSelection(e)}}return false};i.rowIndex=r;i.offsetTop=i.rowIndex*t.rowHeight;i.rowDisplayIndex=0;i.alternatingRowClass=function(){var e=i.rowIndex%2===0;var t={selected:i.selected,"ui-state-default":i.jqueryUITheme&&e,"ui-state-active":i.jqueryUITheme&&!e,even:e,odd:!e};return t};i.beforeSelectionChange=t.beforeSelectionChangeCallback;i.afterSelectionChange=t.afterSelectionChangeCallback;i.getProperty=function(e){return ng.utils.evalProperty(i.entity,e)};i.copy=function(){i.clone=new ng.Row(e,t,n,r);i.clone.isClone=true;i.clone.elm=i.elm;return i.clone};i.setVars=function(e){e.clone=i;i.entity=e.entity;i.selected=e.selected}};ng.SearchProvider=function(e,t,n){var r=this,i=[];r.extFilter=t.config.filterOptions.useExternalFilter;e.showFilter=t.config.showFilter;e.filterText="";r.fieldMap={};r.evalFilter=function(){var e=function(e){for(var t=0,o=i.length;t<o;t++){var u=i[t];var a;if(!u.column){for(var f in e){if(e.hasOwnProperty(f)){var l=r.fieldMap[f];if(!l)continue;var c=null;if(l&&l.cellFilter){var h=l.cellFilter.split(":");c=n(h[0])}var p=e[f];if(p!=null){if(typeof c=="function"){var d=c(typeof p==="object"?s(p,l.field):p).toString();a=u.regex.test(d)}else{a=u.regex.test(typeof p==="object"?s(p,l.field).toString():p.toString())}if(p&&a){return true}}}}return false}var v=r.fieldMap[u.columnDisplay];if(!v){return false}var m=v.cellFilter?n(v.cellFilter):null;var g=e[u.column]||e[v.field.split(".")[0]];if(g==null)return false;if(typeof m=="function"){var y=m(typeof g==="object"?s(g,v.field):g).toString();a=u.regex.test(y)}else{a=u.regex.test(typeof g==="object"?s(g,v.field).toString():g.toString())}if(!g||!a){return false}}return true};if(i.length===0){t.filteredRows=t.rowCache}else{t.filteredRows=t.rowCache.filter(function(t){return e(t.entity)})}for(var o=0;o<t.filteredRows.length;o++){t.filteredRows[o].rowIndex=o}t.rowFactory.filteredRowsChanged()};var s=function(e,t){if(typeof e!="object"||typeof t!="string")return e;var n=t.split(".");var r=e;if(n.length>1){for(var i=1,s=n.length;i<s;i++){r=r[n[i]];if(!r)return e}return r}return e};var o=function(e,t){try{return new RegExp(e,t)}catch(n){return new RegExp(e.replace(/(\^|\$|\(|\)|\<|\>|\[|\]|\{|\}|\\|\||\.|\*|\+|\?)/g,"\\$1"))}};var u=function(e){i=[];var t;if(!(t=$.trim(e))){return}var n=t.split(";");for(var r=0;r<n.length;r++){var s=n[r].split(":");if(s.length>1){var u=$.trim(s[0]);var a=$.trim(s[1]);if(u&&a){i.push({column:u,columnDisplay:u.replace(/\s+/g,"").toLowerCase(),regex:o(a,"i")})}}else{var f=$.trim(s[0]);if(f){i.push({column:"",regex:o(f,"i")})}}}};e.$watch(t.config.filterOptions.filterText,function(t){e.filterText=t});e.$watch("filterText",function(t){if(!r.extFilter){e.$emit("ngGridEventFilter",t);u(t);r.evalFilter()}});if(!r.extFilter){e.$watch("columns",function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.field)r.fieldMap[n.field.split(".")[0]]=n;if(n.displayName)r.fieldMap[n.displayName.toLowerCase().replace(/\s+/g,"")]=n}})}};ng.DomAccessProvider=function(e){var t=this,n;t.selectInputElement=function(e){var t=e.nodeName.toLowerCase();if(t=="input"||t=="textarea"){e.select()}};t.focusCellElement=function(t,r){if(t.selectionService.lastClickedRow){var i=r!=undefined?r:n;var s=t.selectionService.lastClickedRow.clone?t.selectionService.lastClickedRow.clone.elm:t.selectionService.lastClickedRow.elm;if(i!=undefined&&s){var o=angular.element(s[0].children).filter(function(){return this.nodeType!=8});var u=Math.max(Math.min(t.renderedColumns.length-1,i),0);if(e.config.showSelectionCheckbox&&angular.element(o[u]).scope()&&angular.element(o[u]).scope().col.index==0){u=1}if(o[u]){o[u].children[0].focus()}n=i}}};var r=function(e,t){e.css({"-webkit-touch-callout":t,"-webkit-user-select":t,"-khtml-user-select":t,"-moz-user-select":t=="none"?"-moz-none":t,"-ms-user-select":t,"user-select":t})};t.selectionHandlers=function(t,n){var i=false;n.bind("keydown",function(s){if(s.keyCode==16){r(n,"none",s);return true}else if(!i){i=true;var o=ng.moveSelectionHandler(t,n,s,e);i=false;return o}return true});n.bind("keyup",function(e){if(e.keyCode==16){r(n,"text",e)}return true})}};ng.SelectionService=function(e,t){var n=this;n.multi=e.config.multiSelect;n.selectedItems=e.config.selectedItems;n.selectedIndex=e.config.selectedIndex;n.lastClickedRow=undefined;n.ignoreSelectedItemChanges=false;n.ChangeSelection=function(r,i){var s=r.isClone?e.filteredRows[r.rowIndex]:r;if(i&&i.shiftKey&&!i.keyCode&&n.multi&&e.config.enableRowSelection){if(n.lastClickedRow){var o;if(t.configGroups.length>0){o=e.rowFactory.parsedData.filter(function(e){return!e.isAggRow})}else{o=e.filteredRows}var u=s.rowIndex;var a=n.lastClickedRow.rowIndex;n.lastClickedRow=s;if(u==a){return false}if(u<a){u=u^a;a=u^a;u=u^a;u--}else{a++}var f=[];for(;a<=u;a++){f.push(o[a])}if(f[f.length-1].beforeSelectionChange(f,i)){for(var l=0;l<f.length;l++){var c=f[l];var h=c.selected;c.selected=!h;if(c.clone){c.clone.selected=c.selected}var p=n.selectedItems.indexOf(c.entity);if(p===-1){n.selectedItems.push(c.entity)}else{n.selectedItems.splice(p,1)}}f[f.length-1].afterSelectionChange(f,i)}return true}}else if(!n.multi){if(n.lastClickedRow==s){n.setSelection(n.lastClickedRow,e.config.keepLastSelected?true:!s.selected)}else{if(n.lastClickedRow){n.setSelection(n.lastClickedRow,false)}n.setSelection(s,!s.selected)}}else if(!i.keyCode){n.setSelection(s,!s.selected)}n.lastClickedRow=s;return true};n.getSelection=function(e){return n.selectedItems.indexOf(e)!==-1};n.setSelection=function(t,r){var i=t.isClone?e.filteredRows[t.rowIndex]:t;if(e.config.enableRowSelection){i.selected=r;if(i.clone){i.clone.selected=r}if(!r){var s=n.selectedItems.indexOf(i.entity);if(s!=-1){n.selectedItems.splice(s,1)}}else{if(n.selectedItems.indexOf(i.entity)===-1){if(!n.multi&&n.selectedItems.length>0){n.toggleSelectAll(false,true);i.selected=r;if(i.clone){i.clone.selected=r}}n.selectedItems.push(i.entity)}}i.afterSelectionChange(i)}};n.toggleSelectAll=function(t,r){if(r||e.config.beforeSelectionChange(e.filteredRows)){var i=n.selectedItems.length;if(i>0){n.selectedItems.length=0}for(var s=0;s<e.filteredRows.length;s++){e.filteredRows[s].selected=t;if(e.filteredRows[s].clone){e.filteredRows[s].clone.selected=t}if(t){n.selectedItems.push(e.filteredRows[s].entity)}}if(!r){e.config.afterSelectionChange(e.filteredRows)}}}};ng.StyleProvider=function(e,t,n){e.headerCellStyle=function(e){return{height:e.headerRowHeight+"px"}};e.rowStyle=function(t){return{top:t.offsetTop+"px",height:e.rowHeight+"px"}};e.canvasStyle=function(){return{height:t.maxCanvasHt.toString()+"px"}};e.headerScrollerStyle=function(){return{height:t.config.headerRowHeight+"px"}};e.topPanelStyle=function(){return{width:t.rootDim.outerWidth+"px",height:e.topPanelHeight()+"px"}};e.headerStyle=function(){return{width:t.rootDim.outerWidth-n.ScrollW+"px",height:t.config.headerRowHeight+"px"}};e.groupPanelStyle=function(){return{width:t.rootDim.outerWidth-n.ScrollW+"px",height:"30px"}};e.viewportStyle=function(){return{width:t.rootDim.outerWidth+"px",height:e.viewportDimHeight()+"px"}};e.footerStyle=function(){return{width:t.rootDim.outerWidth+"px",height:e.footerRowHeight+"px"}}};n.directive("ngGrid",["$compile","$filter","SortService","DomUtilityService",function(e,t,n,r){var i={scope:true,compile:function(){return{pre:function(i,s,o){var u=$(s);var a=i.$eval(o.ngGrid);a.gridDim=new ng.Dimension({outerHeight:$(u).height(),outerWidth:$(u).width()});var f=new ng.Grid(i,a,n,r,t);if(typeof a.columnDefs=="string"){i.$parent.$watch(a.columnDefs,function(e){if(!e){f.refreshDomSizes();f.buildColumns();return}i.columns=[];f.config.columnDefs=e;f.buildColumns();f.configureColumnWidths();f.eventProvider.assignEvents();r.RebuildGrid(i,f)})}else{f.buildColumns()}if(typeof a.data=="string"){var l=function(e){f.data=$.extend([],e);f.rowFactory.fixRowCache();angular.forEach(f.data,function(e,t){var n=f.rowMap[t]||t;if(f.rowCache[n]){f.rowCache[n].ensureEntity(e)}f.rowMap[n]=t});f.searchProvider.evalFilter();f.configureColumnWidths();f.refreshDomSizes();if(f.config.sortInfo){n.sortData(f.config.sortInfo,f.data.slice(0))}i.$emit("ngGridEventData",f.gridId)};i.$parent.$watch(a.data,l);i.$parent.$watch(a.data+".length",function(){l(i.$eval(a.data))})}f.footerController=new ng.Footer(i,f);s.addClass("ngGrid").addClass(f.gridId.toString());if(a.jqueryUITheme){s.addClass("ui-widget")}s.append(e(ng.gridTemplate())(i));r.AssignGridContainers(i,s,f);f.eventProvider=new ng.EventProvider(f,i,r);angular.forEach(a.plugins,function(e){if(typeof e==="function"){e.call(this,[]).init(i.$new(),f,{SortService:n,DomUtilityService:r})}else{e.init(i.$new(),f,{SortService:n,DomUtilityService:r})}});a.selectRow=function(e,t){if(f.rowCache[e]){f.rowCache[e].setSelection(t?true:false)}};a.selectItem=function(e,t){a.selectRow(f.rowMap[e],t)};a.selectAll=function(e){i.toggleSelectAll(e)};a.groupBy=function(e){if(e){i.groupBy(i.columns.filter(function(t){return t.field==e})[0])}else{var t=$.extend(true,[],i.configGroups);angular.forEach(t,i.groupBy)}};a.sortBy=function(e){var t=i.columns.filter(function(t){return t.field==e})[0];if(t)t.sort()};a.gridId=f.gridId;a.ngGrid=f;a.$gridScope=i;i.$on("ngGridEventDigestGrid",function(){r.digest(i.$parent)});i.$on("ngGridEventDigestGridParent",function(){r.digest(i.$parent)});i.$evalAsync(function(){i.adjustScrollLeft(0)});return null}}}};return i}]);n.directive("ngRow",["$compile","DomUtilityService",function(e,t){var n={scope:false,compile:function(){return{pre:function(n,r){n.row.elm=r;if(n.row.clone){n.row.clone.elm=r}if(n.row.isAggRow){var i=n.aggregateTemplate;if(n.row.aggLabelFilter){i=i.replace(p,"| "+n.row.aggLabelFilter)}else{i=i.replace(p,"")}r.append(e(i)(n))}else{r.append(e(n.rowTemplate)(n))}n.$on("ngGridEventDigestRow",function(){t.digest(n)})}}}};return n}]);n.directive("ngCell",["$compile","DomUtilityService",function(e,t){var n={scope:false,compile:function(){return{pre:function(t,n){var r;var i=t.col.cellTemplate.replace(d,"$eval('row.entity.' + col.field)");if(t.col.enableCellEdit){r=t.col.cellEditTemplate;r=r.replace(v,i);r=r.replace(m,t.col.editableCellTemplate.replace(d,"col.field"))}else{r=i}var s=e(r)(t);if(t.enableCellSelection&&s[0].className.indexOf("ngSelectionCell")==-1){s[0].setAttribute("tabindex",0);s.addClass("ngCellElement")}n.append(s)},post:function(e,n){if(e.enableCellSelection){e.domAccessProvider.selectionHandlers(e,n)}e.$on("ngGridEventDigestCell",function(){t.digest(e)})}}}};return n}]);n.directive("ngHeaderRow",["$compile",function(e){var t={scope:false,compile:function(){return{pre:function(t,n){if(n.children().length===0){n.append(e(t.headerRowTemplate)(t))}}}}};return t}]);n.directive("ngHeaderCell",["$compile",function(e){var t={scope:false,compile:function(){return{pre:function(t,n){n.append(e(t.col.headerCellTemplate)(t))}}}};return t}]);n.directive("ngInput",["$parse",function(e){return function(t,n,r){var i=e(t.$eval(r.ngInput));var s=i.assign;var o=i(t.row.entity);n.val(o);n.bind("keyup",function(){var e=n.val();if(!t.$root.$$phase){t.$apply(function(){s(t.row.entity,e)})}});n.bind("keydown",function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:e.stopPropagation();break;case 27:if(!t.$root.$$phase){t.$apply(function(){s(t.row.entity,o);n.val(o);n.blur()})};default:break}return true})}}]);n.directive("ngViewport",[function(){return function(e,t){var n=false;var r=0;var i=0;t.bind("scroll",function(t){var s=t.target.scrollLeft,o=t.target.scrollTop;if(e.$headerContainer){e.$headerContainer.scrollLeft(s)}var u=r!=s;var a=r<s;var f=i!=o;e.adjustScrollLeft(s);e.adjustScrollTop(o);if(!e.$root.$$phase){e.$digest()}r=s;i=i;n=false;return true});t.bind("mousewheel DOMMouseScroll",function(e){n=true;t.focus();return true});if(!e.enableCellSelection){e.domAccessProvider.selectionHandlers(e,t)}}}]);n.directive("ngCellText",function(){return function(e,t){t.bind("mouseover",function(e){e.preventDefault();t.css({cursor:"pointer"})});t.bind("mouseleave",function(e){e.preventDefault();t.css({cursor:"pointer"})})}});n.directive("ngCellHasFocus",["DomUtilityService",function(e){var t=function(t,n){t.isFocused=true;e.digest(t);var r=angular.element(n[0].children).filter(function(){return this.nodeType!=8});var i=angular.element(r[0].children[0]);if(i.length>0){angular.element(i).focus();t.domAccessProvider.selectInputElement(i[0]);angular.element(i).bind("blur",function(){t.isFocused=false;e.digest(t);return true})}};return function(e,n){var r=false;e.editCell=function(){setTimeout(function(){t(e,n)},0)};n.bind("mousedown",function(e){n.focus();return true});n.bind("focus",function(e){r=true;return true});n.bind("blur",function(e){r=false;return true});n.bind("keydown",function(i){if(r&&i.keyCode!=37&&i.keyCode!=38&&i.keyCode!=39&&i.keyCode!=40&&i.keyCode!=9&&!i.shiftKey&&i.keyCode!=13){t(e,n)}if(i.keyCode==27){n.focus()}return true})}}]);n.directive("ngIf",[function(){return{transclude:"element",priority:1e3,terminal:true,restrict:"A",compile:function(e,t,n){return function(e,t,r){var i;var s;e.$watch(r["ngIf"],function(r){if(i){i.remove();i=undefined}if(s){s.$destroy();s=undefined}if(r){s=e.$new();n(s,function(e){i=e;t.after(e)})}})}}}}]);angular.module("ngGrid",["ngGrid.services","ngGrid.directives","ngGrid.filters"]);e.ngGrid.i18n["en"]={ngAggregateLabel:"items",ngGroupPanelDescription:"Drag a column header here and drop it to group by that column.",ngSearchPlaceHolder:"Search...",ngMenuText:"Choose Columns:",ngShowingItemsLabel:"Showing Items:",ngTotalItemsLabel:"Total Items:",ngSelectedItemsLabel:"Selected Items:",ngPageSizeLabel:"Page Size:",ngPagerFirstTitle:"First Page",ngPagerNextTitle:"Next Page",ngPagerPrevTitle:"Previous Page",ngPagerLastTitle:"Last Page"}})(window)